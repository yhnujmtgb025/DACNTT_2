    <!-- modal edit Card newfeed -->
    <div id="myModal" class="modal">
        <div class="modal-content" id="modCon">
        </div>

    </div>
        
    
    <div id="modal-edit" class="modal">
            <div class="modal-content-edit" id="modal-edit-content">
                <!-- <i class="fas fa-times exit-edit" id="exit-edit" ></i> -->
                <!-- <form style="margin: 0 20px;" id="post-new-feed" enctype="multipart/form-data" onsubmit="return doPost(this);">

                    <div class="card nameCard" id="Newfeed">

                        <div class="container textChat">

                            <div class="comment">

                                <div class="commenter">
                                    <img id="img-text" width="60" height="60" src="<%=image%>" alt="Card image cap"
                                        style="border-radius: 4% 4%;">
                                </div>

                                <div class="coverPost">

                                    <div class="comment-text-area" id="textPost">
                                        <textarea id="cmText" cols="60" rows="4" type="text" name="caption"
                                            placeholder="Add comment ..."></textarea>

                                    </div>

                                </div>

                            </div>

                        </div>

                        <div class="card-body">

                            <div class="imagePost">
                                <div class="gallery-section">
                                    <div class="inner-width">
                                        <div class="gallery" id="gal">
                                       
                                        </div>
                                        <div class="gallery" id="vid">
                                       
                                        </div>
                                    </div>
                                </div>
                            </div>



                            <div class="row iconCard " id="iconPost">


                                <label class="fileContainer">
                                    <svg id="_x31_" enable-background="new 0 0 24 24" height="24"
                                        viewBox="0 0 24 24" width="24">
                                        <g>
                                            <path
                                                d="m17.453 24c-.168 0-.34-.021-.51-.066l-15.463-4.141c-1.06-.292-1.692-1.39-1.414-2.45l1.951-7.272c.072-.267.346-.422.612-.354.267.071.425.346.354.612l-1.95 7.27c-.139.53.179 1.082.71 1.229l15.457 4.139c.531.14 1.079-.176 1.217-.704l.781-2.894c.072-.267.346-.426.613-.353.267.072.424.347.353.613l-.78 2.89c-.235.89-1.045 1.481-1.931 1.481z" />
                                        </g>
                                        <g>
                                            <path
                                                d="m22 18h-16c-1.103 0-2-.897-2-2v-12c0-1.103.897-2 2-2h16c1.103 0 2 .897 2 2v12c0 1.103-.897 2-2 2zm-16-15c-.551 0-1 .449-1 1v12c0 .551.449 1 1 1h16c.551 0 1-.449 1-1v-12c0-.551-.449-1-1-1z" />
                                        </g>
                                        <g>
                                            <path
                                                d="m9 9c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2zm0-3c-.551 0-1 .449-1 1s.449 1 1 1 1-.449 1-1-.449-1-1-1z" />
                                        </g>
                                        <g>
                                            <path
                                                d="m4.57 16.93c-.128 0-.256-.049-.354-.146-.195-.195-.195-.512 0-.707l4.723-4.723c.566-.566 1.555-.566 2.121 0l1.406 1.406 3.892-4.67c.283-.339.699-.536 1.142-.54h.011c.438 0 .853.19 1.139.523l5.23 6.102c.18.209.156.525-.054.705-.209.18-.524.157-.705-.054l-5.23-6.102c-.097-.112-.231-.174-.38-.174-.104-.009-.287.063-.384.18l-4.243 5.091c-.09.108-.221.173-.362.179-.142.01-.277-.046-.376-.146l-1.793-1.793c-.189-.188-.518-.188-.707 0l-4.723 4.723c-.097.097-.225.146-.353.146z" />
                                        </g>
                                    </svg>
                                    <input type="file" name="image" accept="image/*" class=" upload-photo" id="file"
                                        multiple onchange="previewPostImage()">
                                </label>



                                <label class="fileVideo">
                                    <svg height="24" viewBox="0 -87 472 472" width="24">
                                        <path
                                            d="m467.101562 26.527344c-3.039062-1.800782-6.796874-1.871094-9.898437-.179688l-108.296875 59.132813v-35.480469c-.03125-27.601562-22.398438-49.96875-50-50h-248.90625c-27.601562.03125-49.96875 22.398438-50 50v197.421875c.03125 27.601563 22.398438 49.96875 50 50h248.90625c27.601562-.03125 49.96875-22.398437 50-50v-34.835937l108.300781 59.132812c3.097657 1.691406 6.859375 1.625 9.894531-.175781 3.039063-1.804688 4.898438-5.074219 4.898438-8.601563v-227.816406c0-3.53125-1.863281-6.796875-4.898438-8.597656zm-138.203124 220.898437c-.015626 16.5625-13.4375 29.980469-30 30h-248.898438c-16.5625-.019531-29.980469-13.4375-30-30v-197.425781c.019531-16.558594 13.4375-29.980469 30-30h248.90625c16.558594.019531 29.980469 13.441406 30 30zm123.101562-1.335937-103.09375-56.289063v-81.535156l103.09375-56.285156zm0 0" />
                                    </svg>
                                    <input type="file" name="video" accept="video/*" class="upload-photo"
                                        id="fileVideo" multiple onchange="previewPostVideo()">
                                </label>

                                <button class="btn  btnComment btnOpacity post-opa" id="ptNew"
                                    type="submit">Post</button>

                            </div>

                        </div>

                    </div>

                </form>  -->
            </div>
        </div> 

    <div id="display-modal-comment">

    </div>
    
</body>

<script>
     
    // When the user clicks on button cancle the modal
        //  Show notifications liked
        function showNoticeLiked(self) {
            var colorHeart = $(self).children().children().attr("d")
            var color = "M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"
            if(colorHeart == color){
                $("#t4").attr("d","M 34.6 3.1 c -4.5 0 -7.9 1.8 -10.6 5.6 c -2.7 -3.7 -6.1 -5.5 -10.6 -5.5 C 6 3.1 0 9.6 0 17.6 c 0 7.3 5.4 12 10.6 16.5 c 0.6 0.5 1.3 1.1 1.9 1.7 l 2.3 2 c 4.4 3.9 6.6 5.9 7.6 6.5 c 0.5 0.3 1.1 0.5 1.6 0.5 s 1.1 -0.2 1.6 -0.5 c 1 -0.6 2.8 -2.2 7.8 -6.8 l 2 -1.8 c 0.7 -0.6 1.3 -1.2 2 -1.7 C 42.7 29.6 48 25 48 17.6 c 0 -8 -6 -14.5 -13.4 -14.5 Z")
                $("#t1").attr("d","M 45.3 48 H 30 c -0.8 0 -1.5 -0.7 -1.5 -1.5 V 34.2 c 0 -2.6 -2 -4.6 -4.6 -4.6 s -4.6 2 -4.6 4.6 v 12.3 c 0 0.8 -0.7 1.5 -1.5 1.5 H 2.5 c -0.8 0 -1.5 -0.7 -1.5 -1.5 V 23 c 0 -0.4 0.2 -0.8 0.4 -1.1 L 22.9 0.4 c 0.6 -0.6 1.5 -0.6 2.1 0 l 21.5 21.5 c 0.4 0.4 0.6 1.1 0.3 1.6 c 0 0.1 -0.1 0.1 -0.1 0.2 v 22.8 c 0.1 0.8 -0.6 1.5 -1.4 1.5 Z m -13.8 -3 h 12.3 V 23.4 L 24 3.6 l -20 20 V 45 h 12.3 V 34.2 c 0 -4.3 3.3 -7.6 7.6 -7.6 s 7.6 3.3 7.6 7.6 V 45 Z")
            }else{
                $("#t4").attr("d",color)
                $("#t1").attr("d","M45.5 48H30.1c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2.1-4.6-4.6-4.6s-4.6 2.1-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.6-.6 2.1 0l21.5 21.5c.3.3.4.7.4 1.1v23.5c.1.8-.6 1.5-1.4 1.5z")

            }
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/getNotice", true);

            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    var html = ""
                    for (var a = 0; a < response.data.length; a++) {
                      var data = response.data[a];
                        var current_user = response.id

                            for (var b = 0; b < data.notifications.length; b++) {
                                var notice = data.notifications[b];
                                    if( (data._id != notice.idLiked && notice.isRead===false) || data._id != notice.idCommented && (notice.type == 'post_comment' || notice.type == 'reply_comment') ){
                                        html += " <li> "
                                            html+= " <img  src=" + notice.profileImage  +" width="+'30'+" height="+'30'+"  style="+'border-'+'radius:'+'50% 50%'+">"
                                            html+= "<a  data-id="+notice.post._id+" id="+notice._id+" onclick="+'goPost(this)'+">"
                                                html += notice.content
                                            html += "</a>"
                                        html+= "</li>"
                                    }
                                    
                                
                                    
                            }
                        document.getElementById("list-noti").innerHTML = html;
                        
                    }
                  
               
                }
            };
            var formData = new FormData();
            ajax.send(formData);

        }
      
        // Go to card liked
        function goPost(self){
            var val = $(self).attr("data-id")
            var idNotice = $(self).attr("id")
            var myHeart = $("#modalHeart");
            var color = "M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"
            var idCard = "Newfeed-"+val
            var x = document.getElementById(idCard).offsetTop; 
            var body = $("html, body");
            body.stop().animate({scrollTop:x}, 10, 'swing', function() { 
            });
            $.ajax({
                    method: "POST",
                    url: "/postNotice",
                    data: {
                        idPost:val,
                        idNotice:idNotice
                    },
                    cache: false,
                    success: function(responseText) {
                        if (responseText.status == "success") {
                            console.log("data   "+responseText.data)
                            myHeart.removeClass('showHeart') 
                            $("#t4").attr("d",color)
                            $("#t1").attr("d","M45.5 48H30.1c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2.1-4.6-4.6-4.6s-4.6 2.1-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.6-.6 2.1 0l21.5 21.5c.3.3.4.7.4 1.1v23.5c.1.8-.6 1.5-1.4 1.5z")
                            showNotice();
						}
					
                    },
                    error:function(responseText) {
                        alert(responseText)
                    }
                    });
                            
                      

        }
   
        // show notifications followed
        function showNoticeFollowed(self) {
            var colorCompass = $(self).children().children().attr("d")
            var myCompass = $("#modalCompass");
            var color = "M24 0C10.8 0 0 10.8 0 24s10.8 24 24 24 24-10.8 24-24S37.2 0 24 0zm0 45C12.4 45 3 35.6 3 24S12.4 3 24 3s21 9.4 21 21-9.4 21-21 21zm10.2-33.2l-14.8 7c-.3.1-.6.4-.7.7l-7 14.8c-.3.6-.2 1.3.3 1.7.3.3.7.4 1.1.4.2 0 .4 0 .6-.1l14.8-7c.3-.1.6-.4.7-.7l7-14.8c.3-.6.2-1.3-.3-1.7-.4-.5-1.1-.6-1.7-.3zm-7.4 15l-5.5-5.5 10.5-5-5 10.5z"
            if(colorCompass == color){
                $("#t3").attr("d","M 24 0 C 10.8 0 0 10.8 0 24 s 10.8 24 24 24 s 24 -10.8 24 -24 S 37.2 0 24 0 Z m 12.2 13.8 l -7 14.8 c -0.1 0.3 -0.4 0.6 -0.7 0.7 l -14.8 7 c -0.2 0.1 -0.4 0.1 -0.6 0.1 c -0.4 0 -0.8 -0.2 -1.1 -0.4 c -0.4 -0.4 -0.6 -1.1 -0.3 -1.7 l 7 -14.8 c 0.1 -0.3 0.4 -0.6 0.7 -0.7 l 14.8 -7 c 0.6 -0.3 1.3 -0.2 1.7 0.3 c 0.5 0.4 0.6 1.1 0.3 1.7 Z m -15 7.4 l -5 10.5 l 10.5 -5 l -5.5 -5.5 Z")
                $("#t1").attr("d","M 45.3 48 H 30 c -0.8 0 -1.5 -0.7 -1.5 -1.5 V 34.2 c 0 -2.6 -2 -4.6 -4.6 -4.6 s -4.6 2 -4.6 4.6 v 12.3 c 0 0.8 -0.7 1.5 -1.5 1.5 H 2.5 c -0.8 0 -1.5 -0.7 -1.5 -1.5 V 23 c 0 -0.4 0.2 -0.8 0.4 -1.1 L 22.9 0.4 c 0.6 -0.6 1.5 -0.6 2.1 0 l 21.5 21.5 c 0.4 0.4 0.6 1.1 0.3 1.6 c 0 0.1 -0.1 0.1 -0.1 0.2 v 22.8 c 0.1 0.8 -0.6 1.5 -1.4 1.5 Z m -13.8 -3 h 12.3 V 23.4 L 24 3.6 l -20 20 V 45 h 12.3 V 34.2 c 0 -4.3 3.3 -7.6 7.6 -7.6 s 7.6 3.3 7.6 7.6 V 45 Z")
                myCompass.addClass('showCompass') 
            }else{
                $("#t3").attr("d",color)
                $("#t1").attr("d","M45.5 48H30.1c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2.1-4.6-4.6-4.6s-4.6 2.1-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.6-.6 2.1 0l21.5 21.5c.3.3.4.7.4 1.1v23.5c.1.8-.6 1.5-1.4 1.5z")
                myCompass.removeClass('showCompass') 
            }
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/getNotice", true);

            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    var html = ""
                    for (var a = 0; a < response.data.length; a++) {
                      var data = response.data[a];
         
                        var current_user = response.id

                            for (var i = 0; i < data.notifications.length; i++) {
                                var notice = data.notifications[i];
                                    if(notice.type == "follower" && notice.type != "photo_liked" || notice.type =="received_message"){
                                        html += " <li style="+'display:flex'+" > "
                                            html+= " <img  src=" + notice.profileImage  +" width="+'30'+" height="+'30'+"  style="+'border-'+'radius:'+'50% 50%'+">"
                                            html+= "<a  data-id="+notice._id+" id="+notice._id+" >"
                                                html += notice.content
                                            html += "</a>"
                                            if( data.followings.length > 0){
                                                for(var j = 0; j < data.followings.length; j++){
                                                    var follow = data.followings[j];
                                        
                                                    if(follow.idFollowing == notice.idFollowed){
                                                        html+='<button class="btn-notice-'+notice.idFollowed+' followed-notice"  onclick="btnFollow(' + "'" + "this" + "'" + "," + "'" + notice.idFollowed + "'"+"," + "'" + "wordImg" + "'" +"," + "''" + ","  + "'" + notice._id +"'" +')"  type="button" class="btn btn-primary" >'
                                                            html+= '<p  class="clas-'+notice.idFollowed+'">'
                                                                html += 'Unfollow'
                                                            html+= '</p>'
                                                        html+= '</button>'
                                                    }else{
                                                        html+='<button class="btn-notice-'+notice.idFollowed+' follow-notice" onclick="btnFollow(' + "'" + "this" + "'" + "," + "'" + notice.idFollowed + "'"+"," + "'" + "wordImg" + "'" +"," + "'"+notice.id_follow_back+"'" + ","  + "'" + notice._id +"'" +')" type="button" class="btn btn-primary" >'
                                                            html+= '<p  class="clas-'+notice.idFollowed+'">'
                                                                html += 'Follow'
                                                            html+= '</p>'
                                                        html+= '</button>'
                                                    }
                                                 }
                                            }else{
                                           
                                                    html+='<button class="btn-notice-'+notice.idFollowed+' follow-notice" onclick="btnFollow(' + "'" + "this" + "'" + "," + "'" + notice.idFollowed + "'" +"," + "'" + "wordImg" + "'" +"," + "'"+notice.id_follow_back+"'" + ","  + "'" + notice._id +"'" +')" type="button" class="btn btn-primary" >'
                                                        html+= '<p  class="clas-'+notice.idFollowed+'">'
                                                            html += 'Follow'
                                                        html+= '</p>'
                                                    html+= '</button>'
                                            }
                                         
                                         
                                        html+= "</li>"
                                    }
                                   
                                
                                    
                            }
                        document.getElementById("list-noti-compass").innerHTML = html;
                        
                    }
                  
               
                }
            };
            var formData = new FormData();
            ajax.send(formData);

        }

         // follow
         function btnFollow(self, id,clas,id_follow_back,id_notice) {
            $.ajax({
                method: "POST",
                url: "/userFollow",
                data: {
                    _id: id,
                    id_follow_back:id_follow_back,
                    id_notice:id_notice
                },
                cache: false,
                success: function (responseText) {
                    countHeart = responseText.count
                    if (responseText.status == "follow") {
                        if(clas === "wordImg"){
                            $("#right-" + id).text('Unfollow')                  // right card
                            $("#btFollow-"+id).text('Unfollow')                 // follow in profile
                            $(".clas-" + id).text('Unfollow')                   // list scrollbar 
                            $("#lis-" + id).text('Unfollow')                    // list page follow 
                            $(".btn-notice-"+id).removeClass('follow-notice')   // notice
                            $(".btn-notice-"+id).addClass('followed-notice')    
                            $(".btn-notice-"+id).text('Unfollow')  

                            $(".clas-" + id).css('color', '#333')
                            $("#btFollow-"+id).css('color','#333')
                            $("#lis-" + id).css('color','#333') 
                            $(".clas-" + id).css("text-decoration", "none")
                            
                            $("#btFollow-"+id).css('background-color','#fff')
                            $("#lis-"+id).css('background-color','#fff')
                            $(".btn-" + id).css("background-color", "#fff")
                            $(".clas-" + id).css("background-color", "#fff")
                          
                            $("#btFollow-"+id).css('border','0.5px solid #DBDBDB')
                            $("#lis-"+id).css('border','0.5px solid #DBDBDB')
                            $(".btn-" + id).css("border", "0.5px solid #DBDBDB")
                     
                        }
                    }
                    if (responseText.status == "unfollow") {
                        if(clas === "wordImg"){
                            $("#right-" + id).text('Follow')
                            $(".clas-" + id).text('Follow')
                            $("#btFollow-"+id).text('Follow')
                            $("#lis-" + id).text('Follow') 
                            $(".btn-notice-"+id).removeClass('followed-notice')  
                            $(".btn-notice-"+id).addClass('follow-notice')   
                            $(".btn-notice-"+id).text('Follow') 

                            $(".clas-" + id).css('color', '#fff')
                            $("#btFollow-"+id).css('color','#fff')
                            $("#lis-" + id).css('color','#fff')
                           
                            $("#lis-" + id).css('background-color','#0095F6')
                            $("#btFollow-"+id).css('background-color','#0095F6')
                            $(".btn-" + id).css("background-color", "#0095F6")
                            $(".clas-" + id).css("background-color", "#0095F6")
                          
                        }
                    
                    }
                },
                error: function (responseText) {
                    alert(responseText)
                }
            });
        }

        // load follow
        function loadFollow(){
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/getFollow", true);
            
            var userCur = []
            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    var userCur= response.userCur
                    if(response.status == "scroll"){
                        var html = ""
                    var data = response.data
                    var length_user = data.length - 1
 
                    var idCurrent = response.idCurrent
                    html+='<p class="sugCard">Suggestions For You'
                    html+='</p>'
                    html+='<a href="homePage/listFollow" class="seeCard">See All'
                    html+='</a>'
                    html+='<i class="fas fa-chevron-circle-right next" id="next-'+idCurrent+'" onclick="slide('+"'"+"right"+"'"+","+"'"+length_user+"'"+","+"'"+idCurrent+"'"+')">'
                    html+='</i>'
                    html+='<i class="fas fa-chevron-circle-left prev" id="prev-'+idCurrent+'" onclick="slide('+"'"+"left"+"'"+","+"'"+length_user+"'"+","+"'"+idCurrent+"'"+')">'
                    html+='</i>'

                    html+='<div class="coverList" id="co">'
                        html+='<div class="list" id="list-'+idCurrent+'">'
                            html+='<ul id="scroll" data-id="'+idCurrent+'">'
                                for(var i =0; i < data.length;i++){
                                    if(data[i]._id !=idCurrent){
                                        html+=' <li class="item" id="1">'
                                            html+='<div class="cardSug">'
                                                html+='<span class="close">&times;'
                                                html+='</span>'
                                                html+='<img class="imgCardSug" width="65" height="65" src="'+data[i].profileImage+'" alt="Card image cap" style="border-radius: 50% 50%;">'
                                                    html+='<div class="nameBelow">'
                                                        if(data[i].name){
                                                            html+='<form action="/userProfile/'+data[i]._id+'>" method="GET">'
                                                                html+='<a class="nameLink">'
                                                                    html+='<button type="submit">'
                                                                        html += data[i].name    
                                                                    html+='</button>'
                                                                html+='</a>'
                                                            html+='</form> '
                                                        }else{
                                                            html+='<form action="/userProfile/'+data[i]._id+'>" method="GET">'
                                                                html+='<a class="nameLink">'
                                                                    html+='<button type="submit">'
                                                                        html += data[i].fullname    
                                                                    html+='</button>'
                                                                html+='</a>'
                                                            html+='</form> '
                                                        }
                                                        html+='<p class="sug">Suggested for you'
                                                        html+='</p>'
                                                    html+='</div>'
                                                    
                                                    if(userCur[0].followings.length > 0){
                                                        for(var j = 0 ; j< userCur[0].followings.length ; j++){
                                                            if(userCur[0].followings[j].idFollowing.toString() == idCurrent.toString()){
                                                                html+='<button class="btn btnFollowed btn-'+data[i]._id+'" onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">'
                                                                        html+='<a class="centerFollow clas-'+data[i]._id+'">Unfollow'
                                                                        html+='</a>'
                                                                html+='</button>'
                                                            }else{
                                                                html+=' <button class="btn btnFollow btn-'+data[i]._id+'"  onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">'
                                                                    html+='<a href=""  class="centerFollow clas-'+data[i]._id+'">Follow'
                                                                    html+='</a>'
                                                                html+='</button>' 
                                                            }
                                                        }
                                                    }else{
                                                        html+=' <button class="btn btnFollow btn-'+data[i]._id+'"  onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">'
                                                            html+='<a href=""  class="centerFollow clas-'+data[i]._id+'">Follow'
                                                            html+='</a>'
                                                        html+='</button>'  
                                                    }
                                            html+='</div>'
                                        html+='</li>'
                                    }
                                }
                            html+='</ul>'
                        html+='</div>'
                    html+='</div>'

                    $("#scrollBar").html(html)
                    }
                    if(response.right == "right"){
                        var html = ""
                        var curUser = response.curUser
                        html+='<div class="row rightInfor">'
                            html+='<img class="imgUser" width="70" height="70" src="<%=image%>" alt="Card image cap" style="border-radius: 50% 50%;">'
                            html+='<span class="card-title ">'
                                html+='<a href="#" class="nameImg">'
                                    html+= curUser.fullname
                                html+='</a>'
                            html+='</span>'
                            html+='<small id="midName">'
                                html+=curUser.name
                            html+='</small>'
                            html+='<a href="/myProfile" class="wordImg" style="margin-top:1rem;text-decoration: none;">Profile'
                            html+='</a>'
                        html+='</div>'


                        html+='<div class="row rightInfor">'
                            html+='<p style="margin:7px 0 0 10px; font-size: 15px; font-weight: 500; color: #8E8E8E;">Suggestions For You'
                            html+='</p>'
                            html+='<a id="seeAll" href="/homePage/listFollow">See all'
                            html+='</a>'
                        html+='</div>'

                        for(var i =0; i < data.length;i++){
                            if(data[i]._id !=idCurrent){
                            
                                html+='<div class="row belowSuggest">'
                                    html+='<img class="imgUserOther" width="50" height="50" src="'+data[i].profileImage+'" alt="Card image cap" style="border-radius: 50% 50%;">'
                                    html+='<span class="card-title ">'
                                        if(data[i].name){
                                            html+='<form action="/userProfile/'+data[i]._id+'" method="GET">'
                                                html+='<a  class="nameOfUser">'
                                                    html+='<button type="submit" style="border: none;background: none;font-weight: 600;">'
                                                           html += data[i].name 
                                                    html+='</button>'
                                                html+='</a>'
                                            html+='</form>'
                                        }else{
                                            html+='<form action="/userProfile/'+data[i]._id+'" method="GET">'
                                                html+='<a  class="nameOfUser">'
                                                    html+='<button type="submit" style="border: none;background: none;font-weight: 600;">'
                                                        html += data[i].fullname  
                                                    html+='</button>'
                                                html+='</a>'
                                            html+='</form>'
                                        }
                                    html+='</span>'
                                    html+='<small class="midNameUser">Suggested for you'
                                    html+='</small>'
                                    
                                    if(userCur[0].followings.length > 0){
                                        for(var j = 0 ; j< userCur[0].followings.length ; j++){
                                            if(userCur[0].followings[j].idFollowing.toString() == data[i]._id.toString()){      
                                                html+=' <a class="wordImg" id="right-'+data[i]._id+'" onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">Unfollow'
                                                html+='</a>'
                                            }else{
                                                html+=' <a  class="wordImg" id="right-'+data[i]._id+'" onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">Follow'
                                                html+='</a>'
                                            }
                                        }
                                    }else{
                                        html+=' <a  class="wordImg" id="right-'+data[i]._id+'" onclick="btnFollow(this,'+"'" +data[i]._id+"'"+","+"'"+"wordImg"+"'"+')">Follow'
                                        html+='</a>'
                                    }
                                html+='</div>'
                            }
                        }



                    html+='<div class="optionBelow">'
                        html+='<ul class="listHelp">'
                            html+=' <li>'
                                html+='<a href="">About'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li>'
                                html+='<a href="">Help'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li>'
                                html+=' <a href="">Press'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li>'
                                html+=' <a href="">Api'
                                html+='  </a>'
                            html+=' </li>'
                            html+=' <li>'
                                html+='<a href="">Jobs'
                                html+='</a>'
                            html+='</li>'
                            html+='<li>'
                                html+='<a href="">Privacy'
                                html+='</a>'
                            html+='</li>'
                            html+='<li>'
                                html+='<a href="">Terms'
                                html+='</a>'
                            html+='</li>'
                            html+='<br>'
                            html+='<li>'
                                html+='<a href="">Locations'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li> '
                                html+='<a href="">Top Accounts'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li>'
                                html+='<a href="">Hashtags'
                                html+='</a>'
                            html+='</li>'
                            html+=' <li> '
                                html+='<a href="">Language'
                                html+=' </a>'
                            html+='</li>'
                        html+=' </ul>'
                    html+=' <p style="margin-left:2rem; color:#C7C7C7">© 2021 INSTAGRAM FROM FACEBOOK'
                    html+='</p>'
                    html+='</div> '
                    $("#rightCard").html(html)
                    }
                   
                    var len = $('#scrollBar').attr("data-len")
                    var id= $('#scrollBar').attr("data-id")
                    if(len<=3){
                        $('#next-' + id).css("opacity", "0")
                    }
                }
            }
            ajax.send();
        }
    

        // preview image before post
	    var storedFiles = [];
        var filesArr = ''
        var html = ""
        var temp=""
        function previewPostImage() {
            var input = document.getElementById('file');
            var output = document.getElementById('gal');
        
            filesArr=  Array.prototype.slice.call(input.files); 
           
            if($(".check-image").hasClass("image-tag")){
                html=''
            }
            for (var i = 0; i < filesArr.length; ++i) {
                storedFiles.push(filesArr[i])
            }

            for(var i = 0; i< storedFiles.length;i++){
                (function (index) {
                var fileReader = new FileReader();
                        fileReader.onload = function (event) {
                            html += '<div class="image image-tag check-image remove-'+index+'" id="i-' + index + '">'
                                html += '<div class="cover-remove">'
                                    html += '<span class="remove-image" id="span-' + index + '" " onclick="removeImage('+index+')">'
                                    html += `&#x2715`
                                    html += '</span>'
                                html += '</div>'
                                html += '<img src="' + event.target.result + '" id="img-' + index + '" name="imagePost" " alt="">'
                            html += ' </div>'                        
                            output.innerHTML = html; 
                        };
                        fileReader.readAsDataURL(storedFiles[i]);
                        $("#ptNew").css('opacity', "1");
                    })(i);
                }
        }
           
        function removeImage(n) {
            $(".remove-" + n).remove();
            storedFiles.splice(n,1);
        }  
         

        // preview video before post
        var html_v = "";
        var storedFiles_Video = [];
        var filesArr_Video = ''
        function previewPostVideo() {
            var input = document.getElementById('fileVideo');
            var output = document.getElementById('vid');
            filesArr_Video=  Array.prototype.slice.call(input.files); 
            if($(".check-video").hasClass("video-tag")){
                html_v=''
            }
            for (var i = 0; i < filesArr_Video.length; ++i) {
                storedFiles_Video.push(filesArr_Video[i])
            }
            for (var i = 0; i < storedFiles_Video.length; ++i) {
                (function (index) {
                    var fileReader = new FileReader();
                    fileReader.onload = function (event) {
                        html_v += '<div class="image video-tag check-video remove-video-'+index+'""  id="v-'+index+'">'
                            html_v += '<div class="cover-remove-video">'
                                    html_v += '<span class="remove-vid" id="spa' + index + '" onclick="removeVideo(' + index + ')" >'
                                        html_v += '&#x2715'
                                    html_v += '</span>'
                            html_v += '</div>'
                            html_v += '<video  id="video-'+index+'" src="' + event.target.result + '"  id="post-video-preview" controls >'
                            html_v += '</video>'
                        html_v += '</div>'
                        output.innerHTML = html_v;
                    };

                    fileReader.readAsDataURL(storedFiles_Video[i]);
                    $("#ptNew").css('opacity', "1");
                })(i);
            }

        }

        function removeVideo(n) {
            $(".remove-video-" + n).remove();
            storedFiles_Video.splice(n,1);
        }

        // turnoff modal comment
        function returnNewfeed(){
            var span = document.getElementsByClassName("exit-modal-comment")[0]; // Get the <span> element that closes the modal 
            span.addEventListener('click', function(ev) {
                ev.preventDefault();
                $('.modal-com-new').css('display','none')
                $('.sticky-top').css('z-index','1')
                $('.card.nameCard').css('z-index','0')
                $('body').removeClass('stop-scrolling')
                showNewsfeed("return");
            }, false);

        }

        // post newfeed
        function doPost(form) {
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/addPost", true);

            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    if (response.status == "success") {
                        $(".image").css('display', 'none')
                        document.getElementById("post-new-feed").querySelector("textarea[name='caption']").value = "";
                        resetVarPost();
                        showNewsfeed("add");
                        form.reset();
                    }
                    else {
                        alert(response.error)
                    }

                }

            };

            
            var data = new FormData(form);
            var input_image = document.getElementById("file")
            var input_video = document.getElementById("fileVideo")
            if(input_image.files.length>storedFiles.length){   // da xoa anh
                data.delete('image')
                for(var i=0, len=storedFiles.length; i<len; i++) {
                data.append('image', storedFiles[i],storedFiles[i].name);	
                }
            }
            else{                                        // them file
                data.delete('image')
                for(var i=0, len=storedFiles.length; i<len; i++) {
                    data.append('image', storedFiles[i],storedFiles[i].name);	
                }
            }
            if(input_video.files.length>storedFiles_Video.length){   // da xoa video
                data.delete('video')
                for(var i=0, len=storedFiles_Video.length; i<len; i++) {
                    data.append('video', storedFiles_Video[i]);	
                }
            }
            else{                                        // them video
                data.delete('video')
                for(var i=0, len=storedFiles_Video.length; i<len; i++) {
                    data.append('video', storedFiles_Video[i]);	
                }
            }
            ajax.send(data);

            return false;

        }

        // reset variable form post new feed
        function resetVarPost(){
            html_v = "";
            storedFiles_Video = [];
            filesArr_Video = ''
            storedFiles = [];
            filesArr = ''
            html = ""
            temp=""
        }
        // post comment card 
        function doPostComment(form,id){
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/addComment", true);

            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    if (response.status == "success") {
                        var html = ""
                        document.getElementById("post-comment-new").querySelector("textarea[name='commentPost']").value = "";
                        showNewsfeed("comment");
                        form.reset();
                    }
                    else {
                        alert(response.error)
                    }

                }

            };

            var formData = new FormData(form);
            ajax.send(formData);

            return false;
        }
       
        // post comment card modal
        function doPostCommentModal(form){
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/addComment", true);
            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    var html = ""
                    if (response.status == "success") {
                     document.getElementById("post-comment-new").querySelector("textarea[name='commentPost']").value = "";
                     form.reset();
                     modalComment('',response.id_post)
                     hideName(response.id_post)
                    }
                }
            };
            var formData = new FormData(form);
            ajax.send(formData);
            return false;
        }

        // display modal edit of cards newfeed
        function modelCard(self) {
            // handle modal card
            var modal = document.getElementById("myModal");
            var modCon = document.getElementById("modCon");
            var nav = document.getElementById("navColor")
            var id = $(self).attr("data-id")
            var span = document.getElementsByClassName("cancelList")[0]; // Get the <span> element that closes the modal
            var mode = document.getElementsByClassName("modal-content")[0]; 
            var mod = document.getElementsByClassName("modal")[0]; 
            var navbar= document.getElementsByClassName("navbar")[0]; 
            if (id) {
                // When the user clicks the button, open the modal card
                var ml = ''
                ml += '<ul class="list-group listDot">'
                    ml += '<li onclick="editPost('+"'"+id+"'"+')" style="color:red; font-weight:500">Edit'
                    ml += '</li>'
                    ml += '<hr class="hrList">'
                    ml += '<li onclick="deletePost('+"'"+id+"'"+')">Delete'
                    ml += '</li>'
                    ml += '<hr class="hrList">'
                    ml += '<li class="cancelList">Cancel'
                    ml += '</li>'
                ml += '</ul>'
                $("#modCon").html(ml)
                modal.style.display = "block";
                modCon.style.display = "block";
                $('.sticky-top').css('z-index','0')
                $('.card').css('z-index','-1')
                $('body').addClass('stop-scrolling')

                document.getElementsByClassName("cancelList")[0].addEventListener('click',function(){
                    modal.style.display = "none";
                    $('body').removeClass('stop-scrolling')
                    $('.sticky-top').css('z-index','1')
                    $('.card').css('z-index','0')
                }) 
                
            }
                mode.onclick = function () {
                    modal.style.display = "none";
                    modCon.style.display = "none";
                    $('body').removeClass('stop-scrolling')
                    $('.sticky-top').css('z-index','1')
                    $('.card').css('z-index','0')
                }
                mod.onclick = function () {
                    modal.style.display = "none";
                    modCon.style.display = "none";
                    $('body').removeClass('stop-scrolling')
                    $('.sticky-top').css('z-index','1')
                    $('.card').css('z-index','0')
                }
        }
            // When the user clicks on button cancle the modal
    
        // delete post 
        function deletePost(id){
            $.ajax({
                method: "POST",
                url: "/deletePost",
                data: {
                    _id: id
                },
                cache: false,
                success: function (responseText) {
                    if(responseText.status=="success"){
                        showNewsfeed("delete");
                    }
                }
            })
        }

        // post edit new feed
        var arrImg=[]
        var arrVid=[]
        function doPost_Modal(form,id) {
            var ajax = new XMLHttpRequest();
            ajax.open("POST", "/updatePost", true);

            ajax.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.responseText);
                    if (response.status == "success") {
                        $("#modal-edit").css("display","none")
                        $("#modal-edit-content").css("display","none")
                        $('body').removeClass('stop-scrolling-edit')
                        resetVar();
                        showNewsfeed("update");
                        form.reset(); 
                    }
                    else {
                        resetVar();
                        form.reset(); 
                        alert(response.error)
                    }

                }

            };

            var data = new FormData(form);
            // case : them anh moi
            if(storedFiles_Img.length>0){   // da xoa anh
                data.delete('image')
                for(var i=0, len=storedFiles_Img.length; i<len; i++) {
                    data.append('image', storedFiles_Img[i]);	
                }
            }
            //  // case : them video moi
            if(storedFiles_Video.length>0){   // da xoa video
                data.delete('video')
                for(var i=0, len=storedFiles_Video.length; i<len; i++) {
                    data.append('video', storedFiles_Video[i]);	
                }
            }
            // case : xoa anh, sua caption (or ko thay doi j)=> ko them anh
            for(var i=0;i<arrImg.length; i++) {
                data.append("image", JSON.stringify(arrImg[i]));	
            }
            // case : xoa video, sua caption (or ko thay doi j)=> ko them video
            console.log(arrVid.length)
              for(var i=0;i<arrVid.length; i++) {
                data.append("video", JSON.stringify(arrVid[i]));	
            }
            data.append("_id",id)
            ajax.send(data);

            return false;

        }
     
        // edit post
        var html_img =""
        var html_vid =""
        var gan = ""
        var vid = ""
        var len_img = []
        var len_vid = []
        function editPost(id_post){
            var span = document.getElementsByClassName("cancelList")[1]; // Get the <span> element that closes the modal
            var mod = document.getElementsByClassName("modal")[1];
            var j=0
            if(id_post){
                $("#modal-edit").css("display","block")
                $("#modal-edit-content").css("display","block")
                $('body').addClass('stop-scrolling-edit')
            }
            $.ajax({
                method: "POST",
                url: "/getPostModal",
                data: {
                    _id: id_post
                },
                cache: false,
                success: function (responseText) {
                    if (responseText.status == "success") {
                        for (var a = 0; a < responseText.data.length; a++) {
                        var data = responseText.data[a];
                        var user = responseText.user
                        var id = responseText.id
                        var html = ""
                        // modal comment 
                        html +='<i class="fas fa-times exit-edit" id="exit-edit" >'
                        html +='</i>'
                        html+='<form id="post-new-feed-modal" class="post-feed-edit" enctype="multipart/form-data" onsubmit="return doPost_Modal(this,'+"'"+id_post+"'"+');">'

                            html+='<div class="card nameCard" id="Newfeed">'

                                html+='<div class="container textChat">'

                                    html+='<div class="comment">'

                                        html+='<div class="commenter">'
                                            html+='<img id="img-text" width="60" height="60" src="<%=image%>" alt="Card image cap" style="border-radius: 4% 4%;">'
                                        html+='</div>'

                                        html+='<div class="coverPost">'

                                            html+='<div class="comment-text-area" id="textPost">'
                                                html+='<textarea id="cmText" cols="60" rows="4" type="text" name="caption1" placeholder="Add comment ...">' 
                                                    if(data.caption){
                                                        html+=data.caption
                                                    }
                                                html+='</textarea>'
                                            html+='</div>'

                                        html+='</div>'

                                    html+='</div>'

                                html+='</div>'

                                html+='<div class="card-body">'

                                    html+='<div class="imagePost">'
                                        html+='<div class="gallery-section">'
                                            html+='<div class="inner-width">'
                                                html+='<div class="gallery" id="img-modal-edit">'
                                                    if(data.image.length > 0){
                                                        len_img=data.image
                                                        for(var i = 0; i< len_img.length;i++){
                                                            var j = 11+i
                                                          
                                                            arrImg.push(data.image[i])
                                                            var image =  data.image[i]
                                                            var des = image.destination.split('./public/')[1] + '/'
                                                            var name = image.originalname
                                                        
                                                            html += '<div class="image image-modal clone-img remove-mod-'+j+'" id="md-'+j+'">'
                                                                html += '<div class="cover-remove">'
                                                                    html += '<span class="remove-image" id="'+i+'" data-name="'+name+'" onclick="removeImage_Load(this,'+j+')">'
                                                                        html += `&#x2715`
                                                                    html += '</span>'
                                                                html += '</div>'
                                                                html += '<img src="' + des+name + '"  >'
                                                            html+= ' </div>'
                                                           
                                                         
                                                        }
                                                    }
                                                html+='</div>'
                                                html+='<div class="gallery" id="vid-modal-edit">'
                                                    if(data.video.length > 0){
                                                        len_vid=data.video
                                                       for(var i = 0 ; i < len_vid.length;i++){
                                                           var j = 20+i
                                                           arrVid.push(data.video[i])
                                                           var video =  data.video[i]
                                                            var des = video.destination.split('./public/')[1] + '/'
                                                            var name = video.originalname
                                                            html += '<div  class="image clone-vid remove-vid-'+j+'" id="vd-'+j+'">'
                                                                html += '<div class="cover-remove-video">'
                                                                        html += '<span class="remove-vid" id="'+i+'" data-name="'+name+'" onclick="removeVideo_Load(this,'+j+')" >'
                                                                            html += '&#x2715'
                                                                        html += '</span>'
                                                                html += '</div>'
                                                                
                                                            html += '<video  id="video-'+i+'" src="'+des+name+'"  id="post-video-preview" controls >'
                                                            html += '</video>'
                                                            html += '</div>'
                                                       }
                                                        
                                                    }
                                                html+='</div>'
                                            html+='</div>'
                                        html+='</div>'
                                    html+='</div>'



                                    html+='<div class="row iconCard " id="iconPost">'


                                        html+='<label class="fileContainer">'
                                            html+='<svg id="_x31_" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24">'
                                                html+='<g>'
                                                    html+='<path d="m17.453 24c-.168 0-.34-.021-.51-.066l-15.463-4.141c-1.06-.292-1.692-1.39-1.414-2.45l1.951-7.272c.072-.267.346-.422.612-.354.267.071.425.346.354.612l-1.95 7.27c-.139.53.179 1.082.71 1.229l15.457 4.139c.531.14 1.079-.176 1.217-.704l.781-2.894c.072-.267.346-.426.613-.353.267.072.424.347.353.613l-.78 2.89c-.235.89-1.045 1.481-1.931 1.481z" />'
                                                html+='</g>'
                                                html+='<g>'
                                                    html+='<path d="m22 18h-16c-1.103 0-2-.897-2-2v-12c0-1.103.897-2 2-2h16c1.103 0 2 .897 2 2v12c0 1.103-.897 2-2 2zm-16-15c-.551 0-1 .449-1 1v12c0 .551.449 1 1 1h16c.551 0 1-.449 1-1v-12c0-.551-.449-1-1-1z" />'
                                                html+='</g>'
                                                html+='<g>'
                                                html+='<path d="m9 9c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2zm0-3c-.551 0-1 .449-1 1s.449 1 1 1 1-.449 1-1-.449-1-1-1z" />'
                                                html+='</g>'
                                                html+='<g>'
                                                    html+='<path d="m4.57 16.93c-.128 0-.256-.049-.354-.146-.195-.195-.195-.512 0-.707l4.723-4.723c.566-.566 1.555-.566 2.121 0l1.406 1.406 3.892-4.67c.283-.339.699-.536 1.142-.54h.011c.438 0 .853.19 1.139.523l5.23 6.102c.18.209.156.525-.054.705-.209.18-.524.157-.705-.054l-5.23-6.102c-.097-.112-.231-.174-.38-.174-.104-.009-.287.063-.384.18l-4.243 5.091c-.09.108-.221.173-.362.179-.142.01-.277-.046-.376-.146l-1.793-1.793c-.189-.188-.518-.188-.707 0l-4.723 4.723c-.097.097-.225.146-.353.146z" />'
                                                html+='</g>'
                                            html+='</svg>'
                                            html+='<input type="file" name="image" accept="image/*" class=" upload-photo" id="fileImage-modal" multiple onchange="previewPostImage_Modal()">'
                                        html+='</label>'



                                        html+='<label class="fileVideo">'
                                            html+='<svg height="24" viewBox="0 -87 472 472" width="24">'
                                                html+='<path d="m467.101562 26.527344c-3.039062-1.800782-6.796874-1.871094-9.898437-.179688l-108.296875 59.132813v-35.480469c-.03125-27.601562-22.398438-49.96875-50-50h-248.90625c-27.601562.03125-49.96875 22.398438-50 50v197.421875c.03125 27.601563 22.398438 49.96875 50 50h248.90625c27.601562-.03125 49.96875-22.398437 50-50v-34.835937l108.300781 59.132812c3.097657 1.691406 6.859375 1.625 9.894531-.175781 3.039063-1.804688 4.898438-5.074219 4.898438-8.601563v-227.816406c0-3.53125-1.863281-6.796875-4.898438-8.597656zm-138.203124 220.898437c-.015626 16.5625-13.4375 29.980469-30 30h-248.898438c-16.5625-.019531-29.980469-13.4375-30-30v-197.425781c.019531-16.558594 13.4375-29.980469 30-30h248.90625c16.558594.019531 29.980469 13.441406 30 30zm123.101562-1.335937-103.09375-56.289063v-81.535156l103.09375-56.285156zm0 0" />'
                                            html+='</svg>'
                                            html+='<input type="file" name="video" accept="video/*" class="upload-photo" id="fileVideo-modal" multiple onchange="previewPostVideo_Modal()">'
                                        html+='</label>'

                                        html+='<button class="btn  btnComment btnOpacity post-opa" id="ptNew-modal" type="submit">Post'
                                        html+='</button>'

                                    html+='</div>'

                                html+='</div>'

                            html+='</div>'

                        html+='</form>'
                    }
                        $("#modal-edit-content").html(html)
                         // When the user clicks on button cancle the modal
                        document.getElementsByClassName("exit-edit")[0].addEventListener("click",function(){
                            $("#modal-edit").css("display","none")
                            $("#modal-edit-content").css("display","none")
                            $('body').removeClass('stop-scrolling-edit')
                            resetVar();
                        } );
                        gan =$(".clone-img").clone()
                        vid =$(".clone-vid").clone()    
                        for(var a=0;a<len_img.length;a++){
                            html_img+=gan[a].outerHTML
                        }
                        for(var b=0;b<len_vid.length;b++){
                            html_vid+=vid[b].outerHTML
                        }
                        $("#ptNew-modal").css("opacity","1")
                }
                },
                error: function (responseText) {
                    alert(responseText)
                }
            });
        
        }
         
        // preview image before post
	    var storedFiles_Img = [];
        var filesArr_Img = ''
        var html_pre = ''
        function previewPostImage_Modal() {
            var input = document.getElementById('fileImage-modal');
            var output = document.getElementById('img-modal-edit');
            filesArr_Img=  Array.prototype.slice.call(input.files); 
            if($(".image").hasClass("clone-img")){
                html_pre=''
                html_pre=html_img
            }
            if($(".check-modal").hasClass("image-modal")){
                html_pre=''
                html_pre=html_img
            }
            for (var i = 0; i < filesArr_Img.length; ++i) {
                storedFiles_Img.push(filesArr_Img[i])
            }
            for(var i = 0; i< storedFiles_Img.length;i++){
                (function (index) {
                var fileReader = new FileReader();
                        fileReader.onload = function (event) {
                            html_pre += '<div class="image image-modal check-modal remove-modal-'+index+'" id="m-' + index + '">'
                                html_pre += '<div class="cover-remove">'
                                    html_pre += '<span class="remove-image" id="span-' + index  + '"  onclick="removeImage_Modal('+index +')">'
                                    html_pre += `&#x2715`
                                    html_pre += '</span>'
                                html_pre += '</div>'
                                html_pre += '<img src="' + event.target.result + '" id="img-' + index  + '" name="imagePost" alt="">'
                            html_pre += ' </div>'                        
                            output.innerHTML = html_pre; 
                        };
                        fileReader.readAsDataURL(storedFiles_Img[i]); 
                        $("#ptNew-modal").css('opacity', "1");
                    })(i);
                }
           
        }
        
        function removeImage_Load(self,n) {
            var name = $(self).attr("data-name")
            $("#md-"+n).remove()
            for(var i=0;i<arrImg.length;i++){
                if(name.toString() == arrImg[i].originalname){
                    arrImg.splice(i,1)
                }
            }
            html_img=''
            gan =$(".clone-img").clone()
            for(var a=0;a<arrImg.length;a++){
                html_img+=gan[a].outerHTML
            }
        } 
       
        function removeImage_Modal(n) {
            $(".remove-modal-" + n).remove();
            storedFiles_Img.splice(n,1);
        }  
         
        // preview video before post
        var storedFiles_Video = [];
        var filesArr_Video = ''
        var html_aft = ''
        function previewPostVideo_Modal() {
            var input = document.getElementById('fileVideo-modal');
            var output = document.getElementById('vid-modal-edit');
            filesArr_Video=  Array.prototype.slice.call(input.files); 
            if($(".clone-vid").hasClass("image")){
                html_aft=''
                html_aft=html_vid
            }
            if($(".check-vid").hasClass("vid-tag")){
                html_aft=''
                html_aft=html_vid
            }
            for (var i = 0; i < filesArr_Video.length; ++i) {
                storedFiles_Video.push(filesArr_Video[i])
            }
            for (var i = 0; i < storedFiles_Video.length; ++i) {
                (function (index) {
                    var fileReader = new FileReader();
                    fileReader.onload = function (event) {
                        html_aft += '<div class="image vid-tag check-vid remove-vid-'+index+'""  id="vdo-'+index+'">'
                            html_aft += '<div class="cover-remove-video">'
                                    html_aft += '<span class="remove-vid" id="spa' + index + '" onclick="removeVideo_Modal(' + index + ')" >'
                                        html_aft += '&#x2715'
                                    html_aft += '</span>'
                            html_aft += '</div>'
                            html_aft += '<video  id="video-'+index+'" src="' + event.target.result + '"  id="post-video-preview" controls >'
                            html_aft += '</video>'
                        html_aft += '</div>'
                        output.innerHTML = html_aft;
                    };
                    fileReader.readAsDataURL(storedFiles_Video[i]);
                    $("#ptNew-modal").css('opacity', "1");
                })(i);
            }

        }

        function removeVideo_Load(self,n) {
            var name = $(self).attr("data-name")
            $("#vd-"+n).remove()
            for(var i=0;i<arrVid.length;i++){
                if(name.toString() == arrVid[i].originalname){
                    arrVid.splice(i,1)
                }
            }
            html_vid=''
            vid =$(".clone-vid").clone()
            for(var a=0;a<arrVid.length;a++){
                html_vid+=vid[a].outerHTML
            }  
        } 
       
        function removeVideo_Modal(n) {
            $(".remove-vid-" + n).remove();
            storedFiles_Video.splice(n,1);
        }

        // reset variable
        function resetVar(){
            html_img =""
            html_vid =""
            gan = ""
            vid = ""
            len_img = []
            len_vid = []
            storedFiles_Img = [];
            filesArr_Img = ''
            html_pre = ''
            storedFiles_Video = [];
            filesArr_Video = ''
            html_aft = ''
            arrImg=[]
            arrVid=[]
        }
       
        // display modal comment card newfeed
        function modalComment(self,id_post_current) {
            $.ajax({
                method: "POST",
                url: "/getPost",
                data: {
                    _id: id_post_current
                },
                cache: false,
                success: function (responseText) {
                    if (responseText.status == "success") {
                     
                        var html =""
                        for (var a = 0; a < responseText.data.length; a++) {
                        var data = responseText.data[a];
                 
                        var user = responseText.user
                        var id = responseText.id
                        
                        // modal comment 
                        html += ' <div id="modalComment" class="modal-com-new" >'
                            html += ' <div class="modal-content-comment" id="modal-view" >'
                               html += '<i class="fas fa-times exit-modal-comment" id="exit-modal-comment" onclick=returnNewfeed()>'
                                html += '</i>'
                                html+= '<div class="card card-comment" >'
                                    if (data.image.length !== 0 && data.video.length !== 0) {
                                        var sumLength = data.video.length + data.image.length

                                        html += ' <div class="cover-next-prev-modal">'
                                                html += ' <i class="fas fa-chevron-circle-right next-img-modal" id="next-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "right" + "'" + "," + "'" + sumLength + "'" + "," + "'" + data._id + "'" + ')" >'
                                                html += ' </i>'
                                                html += ' <i class="fas fa-chevron-circle-left prev-img-modal"  id="prev-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "left" + "'" + "," + "'" + sumLength + "'" + "," + "'" + data._id + "'" + ')">'
                                                html += ' </i>'
                                        html += '</div>'

                                        html+= '<div class="viewport-modal">'
                                            html+= '<ul class="list-modal" id="list-modal-'+ data._id +'">'
                                            for (var j = 0; j < data.image.length; j++) {
                                                html+= '<li class="item-modal">'
                                                    html += '<img class="card-img-top" src="/demo/' + data.image[j].originalname + ' " alt="Card image cap" style="border-radius: 0%;" >';
                                                html+= '</li>'
                                            }
                                            for (var j = 0; j < data.video.length; j++) {
                                                html += ' <li class="item-image" id="1">'
                                                    html += ' <iframe width="590" height="586" src="/demo/' + data.video[j].originalname + ' " frameborder="0" allowfullscreen sandbox>'
                                                    html += '</iframe>'
                                                html += ' </li>'
                                            }
                                            html+= '</ul>'
                                        html+= ' </div>'
                                        }

                                    if (data.image.length !== 0 && data.video.length == 0) {

                                        html += ' <div class="cover-next-prev-modal">'
                                            if (data.image.length > 1) {
                                                html += ' <i class="fas fa-chevron-circle-right next-img-modal" id="next-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "right" + "'" + "," + "'" + data.image.length + "'" + "," + "'" + data._id + "'" + ')" >'
                                                html += ' </i>'
                                                html += ' <i class="fas fa-chevron-circle-left prev-img-modal"  id="prev-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "left" + "'" + "," + "'" + data.image.length + "'" + "," + "'" + data._id + "'" + ')">'
                                                html += ' </i>'
                                            }
                                        html += '</div>'

                                        html+= '<div class="viewport-modal">'
                                            html+= '<ul class="list-modal" id="list-modal-'+ data._id +'">'
                                            for (var j = 0; j < data.image.length; j++) {
                                                html+= '<li class="item-modal">'
                                                    html += '<img class="card-img-top" src="/demo/' + data.image[j].originalname + ' " alt="Card image cap" style="border-radius: 0%;" >';
                                                html+= '</li>'
                                            }
                                            html+= '</ul>'
                                        html+= ' </div>'

                                    }
                                    
                                    if (data.image.length == 0 && data.video.length !== 0) {
                    
                                        html += ' <div class="cover-next-prev-modal">'
                                            if (data.video.length > 1) {
                                                html += ' <i class="fas fa-chevron-circle-right next-img-modal" id="next-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "right" + "'" + "," + "'" + data.video.length + "'" + "," + "'" + data._id + "'" + ')" >'
                                                html += ' </i>'
                                                html += ' <i class="fas fa-chevron-circle-left prev-img-modal"  id="prev-img-modal-' + data._id + '" onclick="slideImageModal(' + "'" + "left" + "'" + "," + "'" + data.video.length + "'" + "," + "'" + data._id + "'" + ')">'
                                                html += ' </i>'
                                            }
                                        html += '</div>'

                                        html+= '<div class="viewport-modal">'
                                            html+= '<ul class="list-modal" id="list-modal-'+ data._id +'">'
                                                for (var j = 0; j < data.video.length; j++) {
                                                    html += ' <li class="item-image" id="1">'
                                                    html += '   <iframe width="590" height="586" src="/demo/' + data.video[j].originalname + ' " frameborder="0" allowfullscreen sandbox>'
                                                    html += '</iframe>'
                                                    html += ' </li>'
                                                }
                                            html+= '</ul>'
                                        html+= ' </div>'

                                        }
               
                                    if (data.image.length == 0 && data.video.length == 0) {
                                        html+= '<div class="viewport-modal" >'
                                            html+= '<ul class="list-modal" id="list-modal-'+ data._id +'" style="border-right:0.5px solid #EFEFEF">'
                                                html+= '<li class="item-modal" >'
                                                    html += '<img class="card-img-top" src="img/1.png" alt="Card image cap" style="border-radius: 0%; opacity:0">';
                                                html+= '</li>'
                                            html+= '</ul>'
                                        html+= ' </div>'

                                    }

                                        // frame comment
                                    html+= '<div class="card-body" >'
                                        // infor user
                                        html += '<div class="row nameInfor img-cover-modal">';
                                            html += '<img  src=" ' + data.user.profileImage + ' " id="img-user-modal"  alt="Card image cap" >';
                                            html += ' <span class="card-title ">';
                                                html += '<a href="' + '/user/' + data.user.fullname + '" class="nameOf-modal">';
                                                    html += data.user.fullname;
                                                html += '</a>';
                                            html += '</span>';

                                            html += '<i class="fas fa-ellipsis-h action-icon" style="margin-top:10px" id="mod-' + data._id + '" data-id="' + data._id + '" class="threeDot" onclick="modelCard(this)">';
                                            html += '</i>';

                                        html += '</div>';
                                    
                                        // interact user
                                        html += '<div class="view-comment-modal">'
                                            html += '<ul class="list-comment" id="list-comment-id">'
                                                html += '<li class=" item-comment" id="item-comment">'
                                                
                                                        if (data.caption != "" && data.image != "" || data.video != "" ) {
                                                            html += '<img  src=" ' + data.user.profileImage + ' " class="iconComment icon-comment-modal"  alt="Card image cap" >';
                                                            html += '<p  class="likePost">';
                                                            var cap = ""
                                                            for(var j = 0; j < 1; j ++){
                                                                cap +=" "+ data.caption.split(" ")[j] 
                                                            }
                                                                html += ' <p class="card-text caption-text1" id="tag-cap" >';
                                                                    html += data.user.fullname;
                                                                        html += '<span class="cap">'
                                                                            html +=  cap + '...'
                                                                        html += '</span>'
                                                                        html += '<span class="complete">'
                                                                            html += data.caption
                                                                        html += ' </span>'
                                                                        html += '<span class="more" onclick="toggleComment(this)">more'
                                                                        html += '</span>'
                                                                html += '</p>';

                                                        }
                                                            if (data.caption != "" && data.image == "" && data.video =="") {
                                                                html += '<img  src=" ' + data.user.profileImage + ' " class="iconComment icon-comment-modal"  alt="Card image cap" >';
                                                                html += '<p  class="likePost">';
                                                                    var cap = ""
                                                            for(var j = 0; j < 1; j ++){
                                                                cap +=" "+ data.caption.split(" ")[j] 
                                                            }
                                                                html += ' <p class="card-text caption-text1" id="tag-cap" >';
                                                                    html += data.user.fullname;
                                                                        html += '<span class="cap">'
                                                                            html +=  cap + '...'
                                                                        html += '</span>'
                                                                        html += '<span class="complete">'
                                                                            html += data.caption
                                                                        html += ' </span>'
                                                                        html += '<span class="more" onclick="toggleComment(this)">more'
                                                                        html += '</span>'
                                                                html += '</p>';
                                                            }
                                                        
                                                    
                                                        html += '</p>';
                                                html += '</li>'
                                                        
                  
                                                for (var c = 0; c < data.comments.length; c++) {
                                                        var commenter = data.comments[c];
                                                        html += '<li class="item-comment">'               
                                                            html += '<div class="user-chat">'
                                                                html += '<img  src=" ' + commenter.profileImage + ' " class="iconComment user-chat-modal"  alt="Card image cap" >';
                                                                html += '<a>'
                                                                    html += '' +  commenter.fullname
                                                                html += '</a>'

                                                                html += '<span>'
                                                                    html += ''+ commenter.content_comment 
                                                                html += '</span>'
                                                            html += '</div>'
                                                            
                                                            if(commenter.idComment != id){
                                                                html += '<div class="reply-chat">'
                                                                        html += '<ul>'
                                                                            html += '<li>'
                                                                                html += '1w'
                                                                            html += '</li>'  
                                                                            html += '<li>'
                                                                                html += '0 like'
                                                                            html += '</li>'
                                                                                html += '<li>'
                                                                                    html += '<a  onclick="displayName(' + "'" + commenter.fullname + "'"+ "," + "'" + commenter._id + "'"+ "," + "'" + commenter.idComment + "'" + "," + "'" + data._id + "'" +')">'
                                                                                        html += 'Reply'
                                                                                    html +='</a>'  
                                                                                html += '</li>'
                                                                        html += '</ul>'
                                                                html += '</div>'
                                                            }  

                                                            html += '<div class="view-reply">'
                                                                if(commenter.replies){
                                                                    html += '<span onclick="displayReplies(this,'+"'" + c + "'" +','+"'" + commenter.replies.length + "'" +')">'
                                                                        html += '&#9135&#9135&#9135 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;View replies ('+commenter.replies.length+')'
                                                                    html += '</span>'
                                                                }
                                                                html += '<ul class="list-replies list-reply-'+c+'" id="list-reply-'+ c +'">'
                                                                    if(commenter.replies){
                                                                        for(var j = 0 ; j< commenter.replies.length;j++){
                                                                        var reply = commenter.replies[j]
                                                                        html += '<li class="user-reply">'
                                                                            html += '<img  src=" ' + reply.profileImage + ' " class="iconComment user-chat-modal"  alt="Card image cap" >';
                                                                            html += '<a>'
                                                                                html += '' + reply.fullname
                                                                            html += '</a>'
                                                                            html += '<a class="name_replied">'
                                                                                html +=  reply.name_comment
                                                                            html += '</a>'
                                                                            html += '<span>'                         
                                                                                html += ' '+ reply.content_reply
                                                                            html += '</span>'
                                                                        html += '</li>'  
                                                                    }
                                                                    }

                                                                html += '</ul>'
                                                            html += '</div>' 
                                                        html += '</li>'                                              
                                                }
                                            html += '</ul>'
                                        html += '</div>'
                                    
                                        // like, share
                                        var isLiked = false;
                                        for (var b = 0; b < data.likers.length; b++) {
                                            var liker = data.likers[b];
                                            if (liker._id == id) {                      // id user so sanh voi liker
                                                isLiked = true;
                                                break;
                                            }
                                        }
                                        html += '<div class="row modal-icon-newfeed iconCard" style="margin-top:18px">';
                                            html += '<button class="btnHeart ani" data-id="' + data._id + '" onclick="toggleLikeModal(this,' + "'"+ a +"'"+ ','+data.likers.length+','+"'"+data._id+"'"+');" >';
                                                html += '<svg  aria-label="Like" fill="#262626" height="25" viewBox="0 0 48 48" width="25">';
                                                if (isLiked) {
                                                    html += '<path id="heart-modal-' + a + '" fill="#ed4956"  d="M 34.6 3.1 c -4.5 0 -7.9 1.8 -10.6 5.6 c -2.7 -3.7 -6.1 -5.5 -10.6 -5.5 C 6 3.1 0 9.6 0 17.6 c 0 7.3 5.4 12 10.6 16.5 c 0.6 0.5 1.3 1.1 1.9 1.7 l 2.3 2 c 4.4 3.9 6.6 5.9 7.6 6.5 c 0.5 0.3 1.1 0.5 1.6 0.5 s 1.1 -0.2 1.6 -0.5 c 1 -0.6 2.8 -2.2 7.8 -6.8 l 2 -1.8 c 0.7 -0.6 1.3 -1.2 2 -1.7 C 42.7 29.6 48 25 48 17.6 c 0 -8 -6 -14.5 -13.4 -14.5 Z">';
                                                    html += '</path>';
                                                }
                                                else {
                                                    html += '<path id="heart-modal-' + a + '" fill="#262626"  d="M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z">';
                                                    html += '</path>';
                                                }
                                                html += '</svg>';
                                            html += '</button>'
                                            
                                            html += '<button data-id="'+data._id+'" onclick="modalComment(this)" >'
                                                html += ' <svg aria-label="Comment" class="_8-yf5 " fill="#262626" height="24" viewBox="0 0 48 48" width="24">';
                                                    html += '<path clip-rule="evenodd" d="M47.5 46.1l-2.8-11c1.8-3.3 2.8-7.1 2.8-11.1C47.5 11 37 .5 24 .5S.5 11 .5 24 11 47.5 24 47.5c4 0 7.8-1 11.1-2.8l11 2.8c.8.2 1.6-.6 1.4-1.4zm-3-22.1c0 4-1 7-2.6 10-.2.4-.3.9-.2 1.4l2.1 8.4-8.3-2.1c-.5-.1-1-.1-1.4.2-1.8 1-5.2 2.6-10 2.6-11.4 0-20.6-9.2-20.6-20.5S12.7 3.5 24 3.5 44.5 12.7 44.5 24z" fill-rule="evenodd">';
                                                    html += '</path>';
                                                html += '</svg>';
                                            html += '</button>';

                                            html += '<button >';
                                                html += '<svg aria-label="Share Post" class="_8-yf5 " fill="#262626" height="24" viewBox="0 0 48 48" width="24">';
                                                    html += '<path d="M47.8 3.8c-.3-.5-.8-.8-1.3-.8h-45C.9 3.1.3 3.5.1 4S0 5.2.4 5.7l15.9 15.6 5.5 22.6c.1.6.6 1 1.2 1.1h.2c.5 0 1-.3 1.3-.7l23.2-39c.4-.4.4-1 .1-1.5zM5.2 6.1h35.5L18 18.7 5.2 6.1zm18.7 33.6l-4.4-18.4L42.4 8.6 23.9 39.7z">';
                                                    html += '</path>';
                                                html += '</svg>';
                                            html += '</button>';

                                            html += '<button class="savePost">';
                                                html += '<svg aria-label="Save" class="_8-yf5 " fill="#262626" height="24" viewBox="0 0 48 48" width="24">';
                                                    html += '<path class="savePo" d="M43.5 48c-.4 0-.8-.2-1.1-.4L24 29 5.6 47.6c-.4.4-1.1.6-1.6.3-.6-.2-1-.8-1-1.4v-45C3 .7 3.7 0 4.5 0h39c.8 0 1.5.7 1.5 1.5v45c0 .6-.4 1.2-.9 1.4-.2.1-.4.1-.6.1zM24 26c.8 0 1.6.3 2.2.9l15.8 16V3H6v39.9l15.8-16c.6-.6 1.4-.9 2.2-.9z">';
                                                    html += '</path>';
                                                html += '</svg>';
                                            html += '</button>';
                                        html += '</div>';
                                        
                                        html += '<div class="view-like" style="margin-left:0.75rem">'
                                            html += '<small id="like-modal-' + data._id + '" data-id="' + data.likers.length + '" style="font-weight:600">'

                                            if (data.likers.length == "" || data.likers.length == 0) {
                                                html += '0 like</small>'
                                            } else if (data.likers.length == 1) {
                                                html += data.likers.length
                                                html += ' like</small>'
                                            }
                                            else {
                                                html += data.likers.length
                                                html += ' likes</small>'
                                            }
                                        html += '</div>'

                                        html += ' <div class="container textChat">';
                                            html += '<div class="comment">';
                                                html += ' <div class="commenter">';
                                                    html += '<img  src=" ' + user.profileImage + ' " class="iconComment icon-comment-modal"  alt="Card image cap" >';
                                                html += '</div>';

                                                html += '<form id="post-comment-new" onsubmit="return doPostCommentModal(this)">'
                                                    html += '<div class="comment-text-area">';
                                                        html += '<input type="hidden" name="_id" value="'+data._id+'">'
                                                        html += '<input type="hidden" id="nameReply-'+data._id+'" name="nameReply" value="'+data._id+'">'
                                                        html += '<input type="hidden" id="idComment-'+data._id+'" name="id_comment" value="">'
                                                        html += '<input type="hidden" id="idUserComment-'+data._id+'" name="id_user_comment" value="">'
                                                        html += '<textarea class="textinput  textComment text-comment-modal" id="com-'+data._id+'" name="commentPost" placeholder="Add comment ...">'
                                                        html += '</textarea>';
                                                        html += '<button class="btn  btnComment btnOpacity btn-opa" type="submit">Post';
                                                        html += '</button>';
                                                    html += '</div>';
                                                html += '</form>'

                                            html += '</div>';
                                        html += '</div>';

                                    html+= '</div>'
                                html+= ' </div>'
                                html+= '</div>'
                                html+= ' </div>'
                               
                    }
                    $("#display-modal-comment").html(html)
                    $(".modal-com-new").css('display','block')
                    $('.sticky-top').css('z-index','0')
                    $('.card').css('z-index','-1')
                    $('.card.card-comment').css('z-index','1')
                    $('body').addClass('stop-scrolling')
                    }
                
                
                returnNewfeed();
                inputComment();
                dropSave();
                slideImageModal();
                },
                error: function (responseText) {
                    alert(responseText)
                }
            });
        }
        
        // display name in comment reply
        function displayName(name,id_comment,id_user_comment,id_post){
            $('.text-comment-modal').text('@'+name+' ') 
            $('#idComment-'+id_post).val(id_comment)
            $('#nameReply-'+id_post).val('@'+name)
            $('#idUserComment-'+id_post).val(id_user_comment)
        }
        // hide name in comment reply
        function hideName(id_post){
            $('.text-comment-modal').text('') 
            $('#idComment-'+id_post).val('')
            $('#nameReply-'+id_post).val('')
            $('#idUserComment-'+id_post).val('')
        }

        // toggle list reply
        function displayReplies(self,id_reply,length){
            if($('.list-reply-'+id_reply).hasClass('display')){
                $(self).html('&#9135&#9135&#9135 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Views replies('+length+')')
                $('.list-reply-'+id_reply).css('display','none')
                $('.list-reply-'+id_reply).removeClass('display')
            }else{
                $(self).html('&#9135&#9135&#9135 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hide replies')
                $('.list-reply-'+id_reply).css('display','block')
                $('.list-reply-'+id_reply).addClass('display')
            }
            
        }

        // toggle opacity button post
        function inputComment() {
            // handle textarea card
            const messageEle = document.getElementsByClassName('textComment');
            const btnOpa = document.getElementsByClassName("btn-opa")


            for (var i = 0; i < messageEle.length; i++) {
                (function (index) {

                    messageEle[index].addEventListener("input", function (e) {
                        const target = e.target;

                        // Count the current number of characters
                        const currentLength = target.value.length;

                        for (var j = 0; j < btnOpa.length; ++j) {
                            if (currentLength > 0) {
                                btnOpa[index].style.opacity = "1";
                            } else {
                                btnOpa[index].style.opacity = "0.3";
                            }

                        }


                    })

                })(i);



            }

        }

        // toggle opacity button post
        function inputPost() {
            cmText = document.getElementById("cmText")
            ptNew = document.getElementById("ptNew")

            cmText.addEventListener("input", function (e) {
                const target = e.target;

                // Count the current number of characters
                const currentLength = target.value.length;


                if (currentLength > 0) {
                    ptNew.style.opacity = "1";
                } else {
                    ptNew.style.opacity = "0.3";
                }
            })
        }

        // toggle comment
        function toggleComment(self){
            var dot = $('.cap').text()
            if($('.completed').hasClass('completed')){
                $('.completed').toggleClass('complete')    
                $('.complete').removeClass('completed') 
                $('.cap').css('display','')
                $(self).text('more')  
           
            }else{
                $('.complete').toggleClass('completed')    
                $('.completed').removeClass('complete') 
                $(self).text('less')    
                $('.cap').css('display','none')     
            }
           
         
          
        }

        // fill color icon heart card and icon save
        function toggleLike(self, index,numLike) {
            var _id = $(self).attr("data-id")
            var heartID = "#heart-" + index
            var color = $(heartID)
            var c = color.attr("fill")

            $.ajax({
                method: "POST",
                url: "/toggleLike",
                data: {
                    _id: _id
                },
                cache: false,
                success: function (responseText) {
                    countHeart = responseText.count
                    if (responseText.status == "success") {
                        if (c == "#262626") {
                            $(self).toggleClass("anime")
                            $(self).toggleClass("ani")
                            showNewsfeed("like")
                        }

                    }
                    if (responseText.status == "unliked") {
                        if (c == "#ed4956") {
                            $(self).toggleClass("ani")
                            if ($(self).hasClass("anime")) {
                                $(self).toggleClass("anime")
                            } else {
                                $(self).toggleClass("anime")
                            }
                            showNewsfeed("unlike")
                        }
                    }
                },
                error: function (responseText) {
                    alert(responseText)
                }
            });

        }

        // toggle like modal
        function toggleLikeModal(self, index,num,id_post_current) {
            var _id = $(self).attr("data-id")
            var heartID = "#heart-modal-" + index
            var color = $(heartID)
            var c = color.attr("fill")
            $.ajax({
                method: "POST",
                url: "/toggleLike",
                data: {
                    _id: _id
                },
                cache: false,
                success: function (responseText) {
                    if (responseText.status == "success") {
                        if (c == "#262626") {
                            $(self).toggleClass("anime")
                            $(self).toggleClass("ani")
                            color.attr("d", "M 34.6 3.1 c -4.5 0 -7.9 1.8 -10.6 5.6 c -2.7 -3.7 -6.1 -5.5 -10.6 -5.5 C 6 3.1 0 9.6 0 17.6 c 0 7.3 5.4 12 10.6 16.5 c 0.6 0.5 1.3 1.1 1.9 1.7 l 2.3 2 c 4.4 3.9 6.6 5.9 7.6 6.5 c 0.5 0.3 1.1 0.5 1.6 0.5 s 1.1 -0.2 1.6 -0.5 c 1 -0.6 2.8 -2.2 7.8 -6.8 l 2 -1.8 c 0.7 -0.6 1.3 -1.2 2 -1.7 C 42.7 29.6 48 25 48 17.6 c 0 -8 -6 -14.5 -13.4 -14.5 Z")
                            color.attr("fill", "#ed4956")
                            modalComment(self,id_post_current)
                        }

                    }
                    if (responseText.status == "unliked") {
                        if (c == "#ed4956") {
                            $(self).toggleClass("ani")
                            if ($(self).hasClass("anime")) {
                                $(self).toggleClass("anime")
                            } else {
                                $(self).toggleClass("anime")
                            }
                            color.attr("d", "M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z")
                            color.attr("fill", "#262626")
                            modalComment(self,id_post_current)
                        }
                    }
                },
                error: function (responseText) {
                    alert(responseText)
                }
            });

        }

        // Save post
        function dropSave() {
            // fill color icon save card
            var savePost = document.getElementsByClassName("savePost");
            var savePo = document.getElementsByClassName("savePo");
            for (var i = 0; i < savePost.length; i++) {
                (function (index) {
                    savePost[index].addEventListener("click", function (e) {
                        var color = savePo[index].getAttribute("d")
                        var check = "M 43.5 48 c -0.4 0 -0.8 -0.2 -1.1 -0.4 L 24 28.9 L 5.6 47.6 c -0.4 0.4 -1.1 0.6 -1.6 0.3 c -0.6 -0.2 -1 -0.8 -1 -1.4 v -45 C 3 0.7 3.7 0 4.5 0 h 39 c 0.8 0 1.5 0.7 1.5 1.5 v 45 c 0 0.6 -0.4 1.2 -0.9 1.4 c -0.2 0.1 -0.4 0.1 -0.6 0.1 Z"
                        if (color == check) {
                            savePo[index].setAttribute("d", "M43.5 48c-.4 0-.8-.2-1.1-.4L24 29 5.6 47.6c-.4.4-1.1.6-1.6.3-.6-.2-1-.8-1-1.4v-45C3 .7 3.7 0 4.5 0h39c.8 0 1.5.7 1.5 1.5v45c0 .6-.4 1.2-.9 1.4-.2.1-.4.1-.6.1zM24 26c.8 0 1.6.3 2.2.9l15.8 16V3H6v39.9l15.8-16c.6-.6 1.4-.9 2.2-.9z")
                        } else {
                            savePo[index].setAttribute("d", "M 43.5 48 c -0.4 0 -0.8 -0.2 -1.1 -0.4 L 24 28.9 L 5.6 47.6 c -0.4 0.4 -1.1 0.6 -1.6 0.3 c -0.6 -0.2 -1 -0.8 -1 -1.4 v -45 C 3 0.7 3.7 0 4.5 0 h 39 c 0.8 0 1.5 0.7 1.5 1.5 v 45 c 0 0.6 -0.4 1.2 -0.9 1.4 c -0.2 0.1 -0.4 0.1 -0.6 0.1 Z")
                        }

                    })
                })(i);
            }
        }

        // silde image Card
        var t = 0
        function slideImage(direction, size, id) {
            var container = document.getElementById('list-image-newfeed-' + id);
            var x;
            var x1;
            var temp;
         
            scrollCompleted = 0;
            var slideVar = setInterval(function () {
                if (size > 1) {
                    if (direction == "right") {
                        t+=1;
                        container.scrollLeft += 59;
                        if (t>=(size-1)*10) {
                            $('#next-img-' + id).css("opacity", "0")
                            $('#prev-img-' + id).css("opacity", "0.8")
                        } else {
                            $('#prev-img-' + id).css("opacity", "0.8")
                            $('#next-img-' + id).css("opacity", "0.8")
                        }
                        console.log(t)
                    }

                    if (direction == "left") {
                        t-=1;
                        container.scrollLeft -= 59;            
                        if (t<10) {
                            $('#prev-img-' + id).css("opacity", "0")
                            $('#next-img-' + id).css("opacity", "0.8")
                        } else {
                            $('#prev-img-' + id).css("opacity", "0.8")
                            $('#next-img-' + id).css("opacity", "0.8")
                        }
                        console.log(t)
                    }
                    scrollCompleted += 10;
                    if (scrollCompleted >= 100) {
                        window.clearInterval(slideVar);
                    }
                  
                }

            }, 45);
    
        }

         // silde image card modal
         var ax = 0
         function slideImageModal(direction, size, id) {
            var container = document.getElementById('list-modal-' + id);
            var x;
            var x1;
            var temp;
            scrollCompleted = 0;
            var slideVar = setInterval(function () {
                if (size > 1) {
                    if (direction == "right") {
                        ax+=1;
                        container.scrollLeft += 58;
                        if (ax>=(size-1)*10) {
                            $('#next-img-modal-' + id).css("opacity", "0")
                            $('#prev-img-modal-' + id).css("opacity", "0.8")
                        } else {
                            $('#prev-img-modal-' + id).css("opacity", "0.8")
                            $('#next-img-modal-' + id).css("opacity", "0.8")
                        }
                        console.log(ax)
                    }
                    if (direction == "left") {
                        ax-=1;
                        container.scrollLeft -= 58;
                        if (ax < 10) {
                            $('#prev-img-modal-' + id).css("opacity", "0")
                            $('#next-img-modal-' + id).css("opacity", "0.8")
                        } else {
                            $('#prev-img-modal-' + id).css("opacity", "0.8")
                            $('#next-img-modal-' + id).css("opacity", "0.8")
                        }
                        console.log(ax)
                    }
                    scrollCompleted += 10;
                    if (scrollCompleted >= 100) {
                        window.clearInterval(slideVar);
                    }
                }

            }, 45);
        
        }

        
        // scroll by button
        function slide(direction,size,id){
            var container = document.getElementById('list-'+id);
            var x ;
            var x1;
            var temp;
            scrollCompleted = 0;
            var temp = size
            size = (size / 3).toFixed(1)
            temp = temp % 3

            var slideVar = setInterval(function(){
            if(size == 2){
                if (direction == "right") {
                    container.scrollLeft += 58;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == (size * 580) - 580) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 58;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
               
            }else if(size == 3){
                if (direction == "right") {
                    container.scrollLeft += 58;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == (size * 580) - 584) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 58;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
            }
            else if( size == 1.3) {
                if (direction == "right") {
                    container.scrollLeft += 20;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == 196) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 20;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
            }
            else if( size == 1.7) {
                if (direction == "right") {
                    container.scrollLeft += 20;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == 200) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 20;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
            }
            else if( size == 2.3) {
                if (direction == "right") {
                    container.scrollLeft += 20;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == 772) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 20;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
            }
            else if( size == 2.7) {
                if (direction == "right") {
                    container.scrollLeft += 20;
                    x = container.scrollLeft
                    console.log("x : \n"+x)
                    if (x == 964) {
                        $('#next-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
                if (direction == "left") {
                    container.scrollLeft -= 20;
                    x1 = container.scrollLeft
                    if (x1 == 0) {
                        $('#prev-' + id).css("opacity", "0")
                    } else {
                        $('#prev-' + id).css("opacity", "0.2")
                        $('#next-' + id).css("opacity", "0.2")
                    }
                }
            }
            else{
                $('#next-' + id).css("opacity", "0")
            }
            scrollCompleted += 10;
                if (scrollCompleted >= 100) {
                    window.clearInterval(slideVar);
            }
            }, 45);
            }

            
</script>
<script src="/js/iconModal.js"></script>
<script src="/js/filePro.js"></script>
<script src="/js/sendMessage.js"></script>

</html>